/*! {Â© 2016 - 2019 Tinder, Inc., ALL RIGHTS RESERVED} */
(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{1581:function(e,t,a){"use strict";a.r(t),a.d(t,"_sendMessageSaga",(function(){return A})),a.d(t,"sendMessageSaga",(function(){return w})),a.d(t,"_unmatchSaga",(function(){return k})),a.d(t,"unmatchSaga",(function(){return R})),a.d(t,"setLastSeenMatchMessageSaga",(function(){return _})),a.d(t,"setMatchSeenSaga",(function(){return v}));var n=a(7),r=a.n(n),c=a(8),s=a.n(c),o=a(126),u=a.n(o),i=a(0),d=a(10),b=a(11),h=a(20),p=a(16),O=a(3),g=a(27),m=a(55),j=a(9),S=a(1120),f=a(156),M=a(57),x=a(286),l=a(92),I=regeneratorRuntime.mark(A),E=regeneratorRuntime.mark(k);function A(e){var t,a,n,c,s,o,h,O,m,S,E,A,w,k,R;return regeneratorRuntime.wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return Object(b.o)(l.SEND_MESSAGE),t=e.payload.messageData,a=t.match,n=t.matchId,c=t.sessionId,s=t.message,o=t.type,h=t.gif_id,O=t.track_id,m=t.showNotification,S=void 0!==m&&m,E=t.position,A=t.durationInMillis,k=Date.now(),I.prev=4,I.next=7,Object(i.d)(Object(p.q)(p.o,"sendMessage"),n,t);case 7:w=I.sent,I.next=27;break;case 10:if(I.prev=10,I.t0=I.catch(4),!((R=t.retries||0)<3)){I.next=18;break}return Object(b.o)(l.SEND_MESSAGE_RETRY),I.next=17,Object(i.h)(Object(x.e)(r()({},u()(t,["userId"]),{retries:R+1})));case 17:return I.abrupt("return");case 18:return Object(b.o)(l.SEND_MESSAGE_FAILURE),I.next=21,Object(i.h)(Object(g.a)(f.c,{type:o||"text",action:"send",sessionId:c,matchId:n,success:!1,message:s,durationInMillis:A||Date.now()-k,position:E}));case 21:return I.next=23,Object(i.h)(Object(x.d)(I.t0,t));case 23:if(!S){I.next=26;break}return I.next=26,Object(i.h)(Object(M.a)("inApp","","Bg($pink-gradient)",{data:{route:Object(j.c)("messageMatch",{matchId:n})},shouldTranslate:!0,text:"ItsAMatch.sendAMessageFailure",textValues:{name:a.get("name")},avatarImgArray:a.getIn(["photos",0,"processedFiles"],new d.List).map((function(e){return e.get("url")}))},Date.now()));case 26:return I.abrupt("return");case 27:return Object(b.o)(l.SEND_MESSAGE_SUCCESS),I.next=30,Object(i.h)(Object(g.a)(f.c,{type:("song"===o?"vinyl":o)||"text",action:"send",sessionId:c,matchId:n,success:!0,message:s,contentId:h||O,durationInMillis:A||Date.now()-k,position:E}));case 30:return I.next=32,Object(i.h)(Object(x.f)(w,t));case 32:if(!S){I.next=35;break}return I.next=35,Object(i.h)(Object(M.a)("inApp","","Bg($green-gradient-diagonal)",{data:{route:Object(j.c)("messageMatch",{matchId:n})},shouldTranslate:!0,text:"ItsAMatch.sendAMessageSuccess",avatarImgArray:a.getIn(["photos",0,"processedFiles"],new d.List).map((function(e){return e.get("url")}))},Date.now()));case 35:case"end":return I.stop()}}),I,null,[[4,10]])}var w=Object(h.d)(A,{name:"sendMessageSaga"});function k(e){var t,a,n,c,s,o,u,d,h,f,M,I;return regeneratorRuntime.wrap((function(E){for(;;)switch(E.prev=E.next){case 0:return Object(b.o)(l.UNMATCH),m.a.push(Object(j.c)("matches")),t=e.payload,a=t.reasonCustom,n=t.source,c=t.feedbackType,s=t.otherId,o=t.matchId,u=t.selectedCause,d=t.isBoostMatch,h=t.isFastMatch,f=t.isSuperLike,M=0,f&&(M=1),d&&(M=2),h&&(M=3),I={attribution:M,reasonCustom:a,reasonOption:S.REPORT_CAUSES_EVENT_MAP[u],source:n,feedbackType:c,otherId:s,matchId:o},E.prev=8,E.next=11,Object(i.d)(Object(p.q)(p.o,"unmatch"),o);case 11:if(u!==S.REPORT_CAUSES.NO_REASON){E.next=14;break}return E.next=14,Object(i.h)(Object(g.a)(O.U,r()({},I,{feedbackAction:"submit"})));case 14:E.next=25;break;case 16:return E.prev=16,E.t0=E.catch(8),Object(b.o)(l.UNMATCH_FAILURE,E.t0),E.next=21,Object(i.h)(Object(x.p)(o,E.t0));case 21:if(u!==S.REPORT_CAUSES.NO_REASON){E.next=24;break}return E.next=24,Object(i.h)(Object(g.a)(O.U,r()({},I,{feedbackAction:"error"})));case 24:return E.abrupt("return");case 25:return Object(b.o)(l.UNMATCH_SUCCESS),E.next=28,Object(i.h)(Object(x.q)(o));case 28:case"end":return E.stop()}}),E,null,[[8,16]])}var R=Object(h.d)(k,{name:"unmatchSaga"}),_=Object(h.d)(regeneratorRuntime.mark((function e(t){var a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s()(t.payload,"matchId"),n=s()(t.payload,"messageId"),e.next=4,Object(i.d)(Object(p.q)(p.o,"setLastSeenMatchMessage"),a,n);case 4:case"end":return e.stop()}}),e)})),{name:"setLastSeenMatchMessageSaga"}),v=Object(h.d)(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s()(t.payload,"matchId"),e.next=3,Object(i.d)(Object(p.q)(p.o,"setMatchSeen"),a);case 3:case"end":return e.stop()}}),e)})),{name:"setMatchSeenSaga"})}}]);